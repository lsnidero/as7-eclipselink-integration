This library is a collection of utility classes to aid the integration
of EclipseLink into JBossAS7. It bundles the code from:

  https://community.jboss.org/wiki/HowToUseEclipseLinkWithAS7

into a small simple library.

You may add this library as a dependency in your pom to use it private to your
deployment. Alternately, you may add it to the module.xml for an EclipseLink
module that's deployed to the server so it's available to all clients. These
instructions assume you want to take the latter approach.

Each integration point is independent, and if not explicitly activated
is ignored, so you can use only the parts you need. The instructions below
assume you want all of them; if you don't, omit appropriate system
properties as shown below.

TO BUILD
--------

To build this module, run:

  mvn -DskipTests=true clean install

Why skip tests? The tests are Arquillian integration tests that require
JBoss AS 7 to be running locally on default ports unless overridden. Some
of the tests require the VFS integration system property specified below to be
set server-side. The tests will fail unless your environment is set up
correctly, so you can skip them if you just want to produce the library.

The library is produced in target/as7-eclipselink-integration-[VERSION].jar

TO INSTALL ECLIPSELINK INTO JBOSS AS 7
--------------------------------------

The build also produces a read-to-install JBoss AS 7 module for EclipseLink
in target/as7module . You can install it with:

  cp -r target/as7module/* $JBOSS_HOME/modules/

This module includes the integration jar so you don't need to worry about
adding it to your projects' pom.xml files, it'll already be present on
the server.

Now to enable all integration points, run:

  $JBOSS_HOME/bin/jboss-cli.sh --connect 

and in the cli run:

  /system-property=eclipselink.target-server:add(value=JBoss)
  /system-property=eclipselink.archive.factory:add(value=id.au.ringerc.as7.eclipselinkintegration.JBossArchiveFactoryImpl)
  /system-property=eclipselink.logging.logger:add(value=id.au.ringerc.as7.eclipselinkintegration.JBossLogger)

Running "mvn test" for jbossas7_eclipselink_integration should now pass.


VFS INTEGRATION
---------------

VFS integration is controlled by the eclipselink.archive.factory system property.

To enable:

  /system-property=eclipselink.archive.factory:add(value=id.au.ringerc.as7.eclipselinkintegration.JBossArchiveFactoryImpl)

To disable:

  /system-property=eclipselink.archive.factory:remove


It appears that control over VFS integration isn't supported at the persistence.xml properties
level, only as a system property.

LOGGING INTEGRATION
-------------------

Logging integration is controlled by the property eclipselink.logging.logger . This
may be set to id.au.ringerc.as7.eclipselinkintegration.JBossLogger either as a system property
or in persistence.xml. 

in persistence.xml:

  <properties>
    <property name="eclipselink.logging.logger" value="id.au.ringerc.testcase.as7.eclipselink.JBossLogger"/>
  </properties>

... or if you installed the module with bundled integration code, you can set it as a system property:

  $JBOSS_HOME/bin/jboss-cli.sh --connect '/system-property=eclipselink.logging.logger:add(value=id.au.ringerc.as7.eclipselinkintegration.JBossLogger)'

Now optionally increase log detail for EclipseLink. To do this,
stop AS7 (important) then in $JBOSS_HOME/standalone/configuration/standalone.xml
find <subsystem xmlns="urn:jboss:domain:logging:1.1"> and under it add the stanza:

	<logger category="org.eclipse.persistence">
	    <level name="TRACE"/>
	</logger>

... setting whatever logging level you want. Note that if you make this change
while AS 7 is running it'll overwrite it for you when it exits.

PLATFORM ADAPTER FOR ECLIPSELINK 2.3.2
--------------------------------------

If you need to use EclipseLink verisions older than 2.3.2 or 2.3.3, set the
persistence unit property or system property eclipselink.target-server to
id.au.ringerc.as7.eclipselinkintegration.JBossAS7ServerPlatform to work
around bug https://bugs.eclipse.org/bugs/show_bug.cgi?id=365704 .

PLATFORM ADAPTER FOR ECLIPSELINK >= 2.3.3 and >= 2.4.0
------------------------------------------------------

EclipseLink versions that include a fix for 365704 still have to be told
they're on JBoss. You can do this by setting the persistence property
eclipselink.target-server to "jboss", or by setting it as a system property:

  <properties>
    <property name="eclipselink.target-server" value="JBoss"/>
  </properties>

... or system-wide:

  $JBOSS_HOME/bin/jboss-cli.sh --connect '/system-property=eclipselink.target-server:add(value=JBoss)'
